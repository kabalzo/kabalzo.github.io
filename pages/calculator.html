<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tyler's Picks</title>
	<link rel="stylesheet" href="../styles.css" />
</head>
<body>
	<div>
		<h1>Nicolas Cage Movie Night</h1>
	</div>
	
    <div class="menu">
		<ul>
			<li><a href="../index.html">Home</a></li>
			<li><a href="bestofnic.html">Best of Nic</a></li>
			<li><a href="tyler.html">Tyler</a></li>
			<li><a href="alex.html">Alex</a></li>
			<li><a href="trevor.html">Trevor</a></li>
			<li><a href="jordan.html">Jordan</a></li>
			<li><a href="drew.html">Drew</a></li>
			<li><a href="about.html">About</a></li>
		</ul>
	</div>

	<h1>Tier List Calculator</h1>

	<div class="calc"> 
		<p>Tyler</p>
		<input type="text" id="tyler" value="">

		<p>Alex</p>
		<input type="text" id="alex" value="">

		<p>Trevor</p>
		<input type="text" id="trevor" value="">

		<p>Jordan</p>
		<input type="text" id="jordan" value="">

		<p>Drew</p>
		<input type="text" id="drew" value="">

		<div id="test1">
			<p></p>
		</div>
		<div id="test2">
			<p></p>
		</div>
	</div>
	
	<button id="rank" onclick="myFunction()">Rank</button>
	<div id="ranking">
		<p></p>
	</div>

<script>
	function myFunction() {
		var tierValues = {"S": 5, "A": 4, "B": 3, "C": 2, "D": 1, "F": 0}
		var participants = ["tyler", "alex", "trevor", "jordan", "drew"]
		var gradeCounts = {"S": 0, "A": 0, "B": 0, "C": 0, "D": 0, "F": 0}
		var finalGrade = ""
		var participantCount = 5
		var totalScore = 0
		var scoresAverage = 0

		//Assign number values to the letter grade scores inputed
		for (i=0; i <participants.length; i++) {
			var grade = document.getElementById(participants[i]).value.toUpperCase()
			var num = tierValues[grade];
			gradeCounts[grade] += 1
			//If nothing is entered in one of the fields
			if (num == undefined) {
				participantCount -= 1
			}
			else {
				totalScore += num;
			}
		};
		scoresAverage = totalScore/participantCount

		var trump = false
		var ceiling = 0
		for ([key, value] of Object.entries(gradeCounts)) {
			if (participantCount == 0) {
				finalGrade = ":("
			}
			else if (participantCount == 1) {
				finalGrade = key
			}
			else {
				if (ceiling < tierValues[key] && gradeCounts[key] > 0) {
					ceiling = tierValues[key]
				}
				//Check for trump case: n-1 votes for one grade equals that grade, where n is the number of votes
				if (value == (participantCount-1)) {
					finalGrade = key
					trump = true
				} 
				//Alternative trump case where votes for one grade is n-2 but, one vote is greater than the common votes
				//Example: Without this 3xB, 1xF == B, but 2xB 1xA 1xF would equal C
				else if (value == (participantCount-2) && ceiling > tierValues[key] && gradeCounts[key] > 1) {
					finalGrade = key
					trump = true
				}
			}
		}
		
		//Assign a letter grade based on the average score
		if (trump == false) {
			if (scoresAverage >= 4.6) {
				finalGrade = "S"
			} 
			else if (scoresAverage >= 3.6) {
				finalGrade = "A"
			}
			else if (scoresAverage >= 2.6) {
				finalGrade = "B"
			}
			else if (scoresAverage >= 1.6) {
				finalGrade = "C"
			}
			else if (scoresAverage >= 0.6) {
				finalGrade = "D"
			}
			else if (scoresAverage <= 0.5) {
				finalGrade = "F"
			}
		}
		document.getElementById("ranking").innerHTML = finalGrade;
		//document.getElementById("test1").innerHTML = "PARTICIPANTS: " + participantCount + ", TOTAL: " + totalScore + ", AVERAGE: " + scoresAverage;
		//document.getElementById("test2").innerHTML = "S: " + gradeCounts["S"] + ", A:" + gradeCounts["A"] + ", B:"+ gradeCounts["B"] + ", C:"+ gradeCounts["C"] + ", D:"+ gradeCounts["D"] + ", F: "+ gradeCounts["F"] + ", TRUMP: " + trump + ", CEILING: " + ceiling;

		//Reset default vaules each time the button is pressed
		gradeCounts = {"S": 0, "A": 0, "B": 0, "C": 0, "D": 0, "F": 0}
		participantCount = 5
}
</script>
</body>
</html>